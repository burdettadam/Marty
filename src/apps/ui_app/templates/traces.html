{% extends "base.html" %}

{% block title %}Traces - {{ ui_title }}{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h4 class="mb-0"><i class="bi bi-search"></i> Distributed Tracing</h4>
                <p class="mb-0 text-muted">View request flows and performance metrics across all Marty services</p>
            </div>
            <div class="card-body p-0">
                <div class="d-flex justify-content-between align-items-center p-3 border-bottom">
                    <div>
                        <small class="text-muted">Jaeger UI embedded below. Use the search interface to find traces by service, operation, or tags.</small>
                    </div>
                    <div>
                        <a href="{{ jaeger_embed_url }}" target="_blank" class="btn btn-outline-primary btn-sm">
                            <i class="bi bi-box-arrow-up-right"></i> Open in New Tab
                        </a>
                    </div>
                </div>

                <div class="iframe-container" style="height: 700px; overflow: hidden;">
                    <iframe src="{{ jaeger_embed_url }}"
                            style="width: 100%; height: 100%; border: none;"
                            title="Jaeger Tracing Interface">
                    </iframe>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0"><i class="bi bi-lightbulb"></i> Quick Search Tips</h6>
            </div>
            <div class="card-body">
                <ul class="list-unstyled mb-0">
                    <li><i class="bi bi-arrow-right text-primary"></i> Search by service name (e.g., "issuer-api", "trust-svc")</li>
                    <li><i class="bi bi-arrow-right text-primary"></i> Filter by operation (e.g., "issue_credential", "verify_presentation")</li>
                    <li><i class="bi bi-arrow-right text-primary"></i> Look for error tags: <code>error=true</code></li>
                    <li><i class="bi bi-arrow-right text-primary"></i> Use time ranges to focus on recent activity</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0"><i class="bi bi-diagram-3"></i> Common Services</h6>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-6">
                        <small class="text-muted d-block">Core Services:</small>
                        <ul class="list-unstyled small">
                            <li>• issuer-api</li>
                            <li>• trust-svc</li>
                            <li>• document-signer</li>
                            <li>• passport-engine</li>
                        </ul>
                    </div>
                    <div class="col-6">
                        <small class="text-muted d-block">Engine Services:</small>
                        <ul class="list-unstyled small">
                            <li>• mdl-engine</li>
                            <li>• mdoc-engine</li>
                            <li>• dtc-engine</li>
                            <li>• inspection-system</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
