{% extends "base.html" %}

{% block title %}Verify Presentation - {{ ui_title }}{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-8 mx-auto">
        <div class="card">
            <div class="card-header">
                <h4 class="mb-0"><i class="bi bi-check-circle"></i> Verify Verifiable Presentation</h4>
            </div>
            <div class="card-body">
                <form method="post" action="/verify">
                    <div class="mb-3">
                        <label for="presentation_data" class="form-label">Verifiable Presentation JSON *</label>
                        <textarea class="form-control" id="presentation_data" name="presentation_data"
                                  rows="12" required placeholder="Paste the verifiable presentation JSON here..."></textarea>
                        <div class="form-text">Paste the complete verifiable presentation JSON data</div>
                    </div>

                    <div class="mb-3">
                        <label for="verification_policy" class="form-label">Verification Policy</label>
                        <select class="form-select" id="verification_policy" name="verification_policy">
                            <option value="standard">Standard Verification</option>
                            <option value="strict">Strict Verification</option>
                            <option value="lenient">Lenient Verification (Demo)</option>
                        </select>
                        <div class="form-text">Select the verification policy to apply</div>
                    </div>

                    <div class="alert alert-info">
                        <i class="bi bi-info-circle"></i>
                        <strong>Verification Process:</strong> The system will validate the presentation's signature,
                        check expiration dates, verify issuer trust, and confirm revocation status.
                    </div>

                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <button type="button" class="btn btn-secondary" onclick="fillSamplePresentation()">Use Sample Data</button>
                        <button type="submit" class="btn btn-primary">Verify Presentation</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function fillSamplePresentation() {
    const samplePresentation = {
        "@context": [
            "https://www.w3.org/2018/credentials/v1",
            "https://w3id.org/citizenship/v1"
        ],
        "type": ["VerifiablePresentation"],
        "holder": "did:example:holder123",
        "verifiableCredential": [{
            "@context": [
                "https://www.w3.org/2018/credentials/v1",
                "https://w3id.org/citizenship/v1"
            ],
            "type": ["VerifiableCredential", "PassportCredential"],
            "issuer": "did:example:issuer456",
            "issuanceDate": "2023-01-01T00:00:00Z",
            "expirationDate": "2033-01-01T00:00:00Z",
            "credentialSubject": {
                "id": "did:example:subject789",
                "type": "PassportCredential",
                "document_number": "P123456789",
                "issuing_country": "USA",
                "holder_name": "Demo User",
                "birth_date": "1990-01-15"
            },
            "proof": {
                "type": "Ed25519Signature2018",
                "created": "2023-01-01T00:00:00Z",
                "verificationMethod": "did:example:issuer456#key1",
                "proofPurpose": "assertionMethod",
                "jws": "demo_signature_value_for_testing_purposes_only"
            }
        }],
        "proof": {
            "type": "Ed25519Signature2018",
            "created": "2023-01-01T00:00:00Z",
            "verificationMethod": "did:example:holder123#key1",
            "proofPurpose": "authentication",
            "challenge": "demo_challenge_12345",
            "jws": "demo_presentation_signature_for_testing_only"
        }
    };

    document.getElementById('presentation_data').value = JSON.stringify(samplePresentation, null, 2);
}
</script>
{% endblock %}
