{% extends "base.html" %}

{% block title %}Verification Result - {{ ui_title }}{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-10 mx-auto">
        {% if error %}
        <div class="alert alert-danger">
            <h4 class="alert-heading"><i class="bi bi-exclamation-triangle"></i> Verification Failed</h4>
            <p>{{ error }}</p>
        </div>
        
        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
            <a href="/verify" class="btn btn-primary">Try Again</a>
            <a href="/" class="btn btn-secondary">Back to Home</a>
        </div>
        
        {% else %}
        
        {% if verification_result.verified %}
        <div class="alert alert-success">
            <h4 class="alert-heading"><i class="bi bi-check-circle"></i> Presentation Verified Successfully!</h4>
            <p>The verifiable presentation is valid and trusted.</p>
            <hr>
            <p class="mb-0">Verification completed at: {{ verification_result.verification_time }}</p>
        </div>
        {% else %}
        <div class="alert alert-warning">
            <h4 class="alert-heading"><i class="bi bi-exclamation-circle"></i> Presentation Verification Issues</h4>
            <p>The presentation contains some issues that prevented full verification.</p>
        </div>
        {% endif %}
        
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="bi bi-list-check"></i> Verification Checks</h5>
                    </div>
                    <div class="card-body">
                        <div class="list-group list-group-flush">
                            {% for check, result in verification_result.checks.items() %}
                            <div class="list-group-item d-flex justify-content-between align-items-center">
                                <span class="text-capitalize">{{ check.replace('_', ' ') }}</span>
                                {% if result == true or result == 'not_revoked' %}
                                <span class="badge bg-success"><i class="bi bi-check"></i> Pass</span>
                                {% else %}
                                <span class="badge bg-danger"><i class="bi bi-x"></i> Fail</span>
                                {% endif %}
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="bi bi-info-circle"></i> Credential Information</h5>
                    </div>
                    <div class="card-body">
                        <table class="table table-sm">
                            <tr>
                                <td><strong>Type:</strong></td>
                                <td>{{ verification_result.credential_info.type | join(', ') }}</td>
                            </tr>
                            <tr>
                                <td><strong>Holder:</strong></td>
                                <td>{{ verification_result.credential_info.holder }}</td>
                            </tr>
                            <tr>
                                <td><strong>Credentials:</strong></td>
                                <td>{{ verification_result.credential_info.credentials_count }} credential(s)</td>
                            </tr>
                            <tr>
                                <td><strong>Policy:</strong></td>
                                <td><span class="badge bg-info">{{ verification_result.policy_applied }}</span></td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card mt-3">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-file-earmark-text"></i> Presentation Summary</h5>
            </div>
            <div class="card-body">
                <pre class="bg-light p-3 rounded"><code>{{ presentation_summary }}</code></pre>
            </div>
        </div>
        
        <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-3">
            <a href="/verify" class="btn btn-primary">Verify Another</a>
            <a href="/traces" class="btn btn-outline-info">View Trace</a>
        </div>
        
        {% endif %}
    </div>
</div>
{% endblock %}