{% extends "base.html" %}

{% block title %}Metrics - {{ ui_title }}{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h4 class="mb-0"><i class="bi bi-graph-up"></i> System Metrics & Dashboards</h4>
                <p class="mb-0 text-muted">Monitor performance, resource usage, and business metrics across the Marty platform</p>
            </div>
            <div class="card-body p-0">
                <div class="d-flex justify-content-between align-items-center p-3 border-bottom">
                    <div>
                        <small class="text-muted">Grafana dashboards embedded below. Navigate between dashboards to view different metrics.</small>
                    </div>
                    <div>
                        <a href="{{ grafana_embed_url }}" target="_blank" class="btn btn-outline-success btn-sm">
                            <i class="bi bi-box-arrow-up-right"></i> Open in New Tab
                        </a>
                    </div>
                </div>

                <div class="iframe-container" style="height: 700px; overflow: hidden;">
                    <iframe src="{{ grafana_embed_url }}"
                            style="width: 100%; height: 100%; border: none;"
                            title="Grafana Metrics Dashboard">
                    </iframe>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0"><i class="bi bi-speedometer2"></i> Key Metrics</h6>
            </div>
            <div class="card-body">
                <ul class="list-unstyled mb-0">
                    <li><i class="bi bi-arrow-right text-success"></i> Request throughput (req/sec)</li>
                    <li><i class="bi bi-arrow-right text-success"></i> Response latency (p95, p99)</li>
                    <li><i class="bi bi-arrow-right text-success"></i> Error rates by service</li>
                    <li><i class="bi bi-arrow-right text-success"></i> Resource utilization</li>
                    <li><i class="bi bi-arrow-right text-success"></i> Database connections</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0"><i class="bi bi-trophy"></i> Business Metrics</h6>
            </div>
            <div class="card-body">
                <ul class="list-unstyled mb-0">
                    <li><i class="bi bi-arrow-right text-primary"></i> Credentials issued</li>
                    <li><i class="bi bi-arrow-right text-primary"></i> Verifications performed</li>
                    <li><i class="bi bi-arrow-right text-primary"></i> Trust anchor sync status</li>
                    <li><i class="bi bi-arrow-right text-primary"></i> PKD synchronization</li>
                    <li><i class="bi bi-arrow-right text-primary"></i> Certificate validations</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0"><i class="bi bi-tools"></i> Quick Links</h6>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <a href="http://localhost:9090" target="_blank" class="btn btn-outline-warning btn-sm">
                        <i class="bi bi-speedometer2"></i> Prometheus
                    </a>
                    <a href="http://localhost:3000/dashboards" target="_blank" class="btn btn-outline-success btn-sm">
                        <i class="bi bi-grid"></i> All Dashboards
                    </a>
                    <a href="http://localhost:3000/alerting" target="_blank" class="btn btn-outline-danger btn-sm">
                        <i class="bi bi-bell"></i> Alerts
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
