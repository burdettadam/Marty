{% extends "base.html" %}
{% block content %}
<section class="layout-two-column">
  <article class="card">
    <header><h2>Process Passport</h2></header>
    <form method="post" action="/passport/process" class="form">
      <label for="passport_number">Passport Number</label>
      <input id="passport_number" name="passport_number" placeholder="Enter or leave blank to auto-generate">
      <button type="submit">Process</button>
    </form>
    {% if process_result %}
      <div class="result-panel">
        <h3>Status: <span class="status-{{ process_result.status|lower }}">{{ process_result.status }}</span></h3>
        <p><strong>Passport:</strong> {{ process_result.passport_number }}</p>
        {% if process_result.error %}
          <p class="error">{{ process_result.error }}</p>
        {% else %}
          <p>{{ process_result.message }}</p>
        {% endif %}
      </div>
    {% endif %}
  </article>
  <article class="card">
    <header><h2>Inspect Passport</h2></header>
    <form method="post" action="/passport/inspect" class="form">
      <label for="inspect_passport_number">Passport Number</label>
      <input id="inspect_passport_number" name="passport_number" required>
      <button type="submit">Inspect</button>
    </form>
    {% if inspection_result %}
      <div class="result-panel">
        <h3>Status: <span class="status-{{ inspection_result.status|lower }}">{{ inspection_result.status }}</span></h3>
        {% if inspection_result.error %}
          <p class="error">{{ inspection_result.error }}</p>
        {% else %}
          <pre class="result-text">{{ inspection_result.result }}</pre>
        {% endif %}
      </div>
    {% endif %}
    <!-- Multiple results support for E2E testing -->
    {% if process_result and inspection_result %}
      <!-- Both process and inspection results exist, ensure both panels are visible -->
      <script>
        // Ensure result panels are properly indexed for E2E testing
        document.querySelectorAll('.result-panel').forEach((panel, index) => {
          panel.setAttribute('data-result-index', index);
        });
      </script>
    {% endif %}
  </article>
</section>
{% endblock %}
