{% extends "base.html" %}
{% block content %}
<section class="grid">
  <article class="card">
    <header>
      <h2>Trust Anchor Management</h2>
    </header>
    
    <!-- Certificate Validation Section -->
    <details open>
      <summary>Certificate Validation</summary>
      
      <div class="validation-section">
        <h4>Validate Certificate</h4>
        <form method="post" action="/trust-anchor/validate" enctype="multipart/form-data">
          <div class="form-row">
            <div class="form-group">
              <label for="cert_file">Certificate File:</label>
              <input type="file" id="cert_file" name="certificate_file" 
                     accept=".pem,.cer,.crt,.der" required>
              <small class="help-text">Supported formats: PEM, DER, CER, CRT</small>
            </div>
            
            <div class="form-group">
              <label for="validation_context">Validation Context:</label>
              <select id="validation_context" name="validation_context">
                <option value="PASSPORT">Passport Verification</option>
                <option value="MDL">Mobile Driving License</option>
                <option value="MDOC">Mobile Document</option>
                <option value="DTC">Digital Travel Credential</option>
                <option value="GENERAL">General Purpose</option>
              </select>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" name="check_revocation" value="true" checked>
                Check certificate revocation status
              </label>
            </div>
            
            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" name="validate_chain" value="true" checked>
                Validate certificate chain
              </label>
            </div>
          </div>
          
          <button type="submit" class="button button-primary">Validate Certificate</button>
        </form>
        
        {% if validation_result %}
          <div class="result-section">
            <h5>Validation Result</h5>
            <div class="validation-details">
              <div class="validation-status">
                <span class="status status-{{ 'valid' if validation_result.is_valid else 'invalid' }}">
                  {{ 'VALID' if validation_result.is_valid else 'INVALID' }}
                </span>
                {% if validation_result.trust_level %}
                  <span class="trust-level trust-{{ validation_result.trust_level|lower }}">
                    Trust Level: {{ validation_result.trust_level }}
                  </span>
                {% endif %}
              </div>
              
              {% if validation_result.certificate_info %}
                <div class="cert-info-grid">
                  <div class="info-section">
                    <h6>Certificate Information</h6>
                    <dl>
                      <dt>Subject:</dt><dd>{{ validation_result.certificate_info.subject }}</dd>
                      <dt>Issuer:</dt><dd>{{ validation_result.certificate_info.issuer }}</dd>
                      <dt>Serial Number:</dt><dd>{{ validation_result.certificate_info.serial_number }}</dd>
                      <dt>Valid From:</dt><dd>{{ validation_result.certificate_info.valid_from }}</dd>
                      <dt>Valid To:</dt><dd>{{ validation_result.certificate_info.valid_to }}</dd>
                    </dl>
                  </div>
                  
                  <div class="info-section">
                    <h6>Validation Details</h6>
                    <dl>
                      <dt>Chain Valid:</dt><dd>{{ 'Yes' if validation_result.chain_valid else 'No' }}</dd>
                      <dt>Signature Valid:</dt><dd>{{ 'Yes' if validation_result.signature_valid else 'No' }}</dd>
                      <dt>Time Valid:</dt><dd>{{ 'Yes' if validation_result.time_valid else 'No' }}</dd>
                      <dt>Revocation Status:</dt><dd>{{ validation_result.revocation_status or 'Not checked' }}</dd>
                    </dl>
                  </div>
                </div>
              {% endif %}
              
              {% if validation_result.errors %}
                <div class="validation-errors">
                  <h6>Validation Errors</h6>
                  <ul class="error-list">
                    {% for error in validation_result.errors %}
                      <li>{{ error }}</li>
                    {% endfor %}
                  </ul>
                </div>
              {% endif %}
              
              {% if validation_result.warnings %}
                <div class="validation-warnings">
                  <h6>Warnings</h6>
                  <ul class="warning-list">
                    {% for warning in validation_result.warnings %}
                      <li>{{ warning }}</li>
                    {% endfor %}
                  </ul>
                </div>
              {% endif %}
            </div>
          </div>
        {% endif %}
      </div>
    </details>
    
    <!-- Trust Store Management -->
    <details>
      <summary>Trust Store Management</summary>
      
      <div class="trust-store-section">
        <!-- Add Trusted Certificate -->
        <div class="add-trust-section">
          <h4>Add Trusted Certificate</h4>
          <form method="post" action="/trust-anchor/add-trusted" enctype="multipart/form-data">
            <div class="form-row">
              <div class="form-group">
                <label for="trusted_cert_file">Certificate File:</label>
                <input type="file" id="trusted_cert_file" name="certificate_file" 
                       accept=".pem,.cer,.crt,.der" required>
              </div>
              
              <div class="form-group">
                <label for="trust_purpose">Trust Purpose:</label>
                <select id="trust_purpose" name="trust_purpose" multiple>
                  <option value="PASSPORT_VERIFICATION">Passport Verification</option>
                  <option value="MDL_VERIFICATION">MDL Verification</option>
                  <option value="MDOC_VERIFICATION">mDoc Verification</option>
                  <option value="DTC_VERIFICATION">DTC Verification</option>
                  <option value="CERTIFICATE_SIGNING">Certificate Signing</option>
                </select>
                <small class="help-text">Hold Ctrl/Cmd to select multiple purposes</small>
              </div>
              
              <div class="form-group">
                <label for="trust_level">Trust Level:</label>
                <select id="trust_level" name="trust_level" required>
                  <option value="HIGH">High Trust (Root CA)</option>
                  <option value="MEDIUM">Medium Trust (Intermediate CA)</option>
                  <option value="LOW">Low Trust (End Entity)</option>
                </select>
              </div>
            </div>
            
            <div class="form-group">
              <label for="trust_notes">Notes (optional):</label>
              <textarea id="trust_notes" name="notes" rows="2" 
                        placeholder="Additional information about this trusted certificate..."></textarea>
            </div>
            
            <button type="submit" class="button button-primary">Add to Trust Store</button>
          </form>
        </div>
        
        <!-- Trust Store Browser -->
        <div class="trust-browser-section">
          <h4>Trusted Certificates</h4>
          
          <!-- Filter and Search -->
          <div class="trust-filters">
            <form method="get" action="/trust-anchor" class="filter-form">
              <div class="form-row">
                <div class="form-group">
                  <label for="trust_search">Search:</label>
                  <input type="text" id="trust_search" name="search" 
                         placeholder="Subject, issuer, or purpose..." 
                         value="{{ search_query }}">
                </div>
                
                <div class="form-group">
                  <label for="trust_level_filter">Trust Level:</label>
                  <select id="trust_level_filter" name="trust_level">
                    <option value="">All levels</option>
                    <option value="HIGH" {% if trust_level == 'HIGH' %}selected{% endif %}>High</option>
                    <option value="MEDIUM" {% if trust_level == 'MEDIUM' %}selected{% endif %}>Medium</option>
                    <option value="LOW" {% if trust_level == 'LOW' %}selected{% endif %}>Low</option>
                  </select>
                </div>
                
                <div class="form-group">
                  <label for="purpose_filter">Purpose:</label>
                  <select id="purpose_filter" name="purpose">
                    <option value="">All purposes</option>
                    <option value="PASSPORT_VERIFICATION">Passport Verification</option>
                    <option value="MDL_VERIFICATION">MDL Verification</option>
                    <option value="MDOC_VERIFICATION">mDoc Verification</option>
                    <option value="DTC_VERIFICATION">DTC Verification</option>
                    <option value="CERTIFICATE_SIGNING">Certificate Signing</option>
                  </select>
                </div>
              </div>
              
              <div class="filter-actions">
                <button type="submit" class="button">Filter</button>
                <button type="button" class="button" onclick="clearFilters()">Clear</button>
              </div>
            </form>
          </div>
          
          {% if trusted_certificates %}
            <div class="trusted-certs-list">
              {% for cert in trusted_certificates %}
                <div class="trusted-cert-card">
                  <div class="cert-header">
                    <div class="cert-title">
                      <h6>{{ cert.subject_name }}</h6>
                      <span class="trust-level trust-{{ cert.trust_level|lower }}">{{ cert.trust_level }}</span>
                    </div>
                    <div class="cert-status">
                      <span class="status status-{{ cert.status|lower }}">{{ cert.status }}</span>
                    </div>
                  </div>
                  
                  <div class="cert-details">
                    <dl>
                      <dt>Issuer:</dt><dd>{{ cert.issuer_name }}</dd>
                      <dt>Valid From:</dt><dd>{{ cert.valid_from }}</dd>
                      <dt>Valid To:</dt><dd>{{ cert.valid_to }}</dd>
                      <dt>Purposes:</dt><dd>{{ cert.purposes|join(', ') }}</dd>
                      {% if cert.notes %}<dt>Notes:</dt><dd>{{ cert.notes }}</dd>{% endif %}
                    </dl>
                  </div>
                  
                  <div class="cert-actions">
                    <button class="button button-small" onclick="viewTrustedCert('{{ cert.certificate_id }}')">View</button>
                    <button class="button button-small" onclick="downloadTrustedCert('{{ cert.certificate_id }}')">Download</button>
                    <button class="button button-small" onclick="editTrust('{{ cert.certificate_id }}')">Edit</button>
                    <button class="button button-small button-danger" onclick="removeTrust('{{ cert.certificate_id }}')">Remove</button>
                  </div>
                </div>
              {% endfor %}
            </div>
          {% else %}
            <div class="no-trusted-certs">
              <p>No trusted certificates found. Add certificates to the trust store to enable validation.</p>
            </div>
          {% endif %}
        </div>
      </div>
    </details>
    
    <!-- Certificate Expiry Monitoring -->
    <details>
      <summary>Certificate Expiry Monitoring</summary>
      
      <div class="expiry-section">
        <div class="expiry-controls">
          <h4>Expiry Monitoring Settings</h4>
          <form method="post" action="/trust-anchor/expiry-settings">
            <div class="form-row">
              <div class="form-group">
                <label for="notification_days">Notification Thresholds (days):</label>
                <input type="text" id="notification_days" name="notification_days" 
                       placeholder="30,15,7,3,1" 
                       value="{{ expiry_settings.notification_days|join(',') if expiry_settings else '30,15,7,3,1' }}">
                <small class="help-text">Comma-separated list of days before expiry to send notifications</small>
              </div>
              
              <div class="form-group">
                <label class="checkbox-label">
                  <input type="checkbox" name="enable_notifications" value="true" 
                         {% if expiry_settings and expiry_settings.notifications_enabled %}checked{% endif %}>
                  Enable email notifications
                </label>
              </div>
            </div>
            
            <div class="form-group">
              <label for="notification_email">Notification Email:</label>
              <input type="email" id="notification_email" name="notification_email" 
                     value="{{ expiry_settings.notification_email if expiry_settings else '' }}"
                     placeholder="admin@example.com">
            </div>
            
            <button type="submit" class="button">Update Settings</button>
          </form>
        </div>
        
        <!-- Expiring Certificates Alert -->
        <div class="expiry-alerts">
          <h4>Certificate Expiry Alerts</h4>
          <button class="button" onclick="checkExpiringCertificates()">Check for Expiring Certificates</button>
          
          {% if expiring_certificates %}
            <div class="alert-summary">
              <div class="alert-stats">
                <div class="alert-stat critical">
                  <strong>{{ expiring_certificates.expired|length }}</strong>
                  <span>Expired</span>
                </div>
                <div class="alert-stat urgent">
                  <strong>{{ expiring_certificates.expiring_soon|length }}</strong>
                  <span>Expiring Soon</span>
                </div>
                <div class="alert-stat warning">
                  <strong>{{ expiring_certificates.expiring_later|length }}</strong>
                  <span>Expiring Later</span>
                </div>
              </div>
            </div>
            
            {% if expiring_certificates.expired %}
              <div class="expired-certs">
                <h5 class="alert-section-title critical">Expired Certificates</h5>
                <div class="cert-alerts-list">
                  {% for cert in expiring_certificates.expired %}
                    <div class="cert-alert cert-expired">
                      <div class="cert-alert-info">
                        <strong>{{ cert.subject_name }}</strong>
                        <span class="expiry-date">Expired: {{ cert.valid_to }}</span>
                      </div>
                      <div class="cert-alert-actions">
                        <button class="button button-small" onclick="viewCertDetails('{{ cert.certificate_id }}')">View</button>
                        <button class="button button-small button-danger" onclick="removeTrust('{{ cert.certificate_id }}')">Remove</button>
                      </div>
                    </div>
                  {% endfor %}
                </div>
              </div>
            {% endif %}
            
            {% if expiring_certificates.expiring_soon %}
              <div class="expiring-soon-certs">
                <h5 class="alert-section-title urgent">Expiring Soon (≤7 days)</h5>
                <div class="cert-alerts-list">
                  {% for cert in expiring_certificates.expiring_soon %}
                    <div class="cert-alert cert-expiring-soon">
                      <div class="cert-alert-info">
                        <strong>{{ cert.subject_name }}</strong>
                        <span class="expiry-date">Expires: {{ cert.valid_to }} ({{ cert.days_until_expiry }} days)</span>
                      </div>
                      <div class="cert-alert-actions">
                        <button class="button button-small" onclick="viewCertDetails('{{ cert.certificate_id }}')">View</button>
                        <button class="button button-small" onclick="renewCert('{{ cert.certificate_id }}')">Renew</button>
                      </div>
                    </div>
                  {% endfor %}
                </div>
              </div>
            {% endif %}
          {% endif %}
        </div>
      </div>
    </details>
    
    <!-- Service Status -->
    <details>
      <summary>Service Status & Health</summary>
      
      <div class="status-section">
        <div class="service-health">
          <h4>Service Health Status</h4>
          <button class="button" onclick="refreshServiceStatus()">Refresh Status</button>
          
          {% if service_status %}
            <div class="health-grid">
              <div class="health-card">
                <h6>Trust Anchor Service</h6>
                <div class="health-status status-{{ service_status.trust_anchor.status|lower }}">
                  {{ service_status.trust_anchor.status }}
                </div>
                <div class="health-details">
                  <dl>
                    <dt>Uptime:</dt><dd>{{ service_status.trust_anchor.uptime }}</dd>
                    <dt>Memory Usage:</dt><dd>{{ service_status.trust_anchor.memory_usage }}</dd>
                    <dt>Response Time:</dt><dd>{{ service_status.trust_anchor.response_time }}</dd>
                  </dl>
                </div>
              </div>
              
              <div class="health-card">
                <h6>Certificate Store</h6>
                <div class="health-status status-{{ service_status.certificate_store.status|lower }}">
                  {{ service_status.certificate_store.status }}
                </div>
                <div class="health-details">
                  <dl>
                    <dt>Certificates:</dt><dd>{{ service_status.certificate_store.certificate_count }}</dd>
                    <dt>Storage Used:</dt><dd>{{ service_status.certificate_store.storage_used }}</dd>
                    <dt>Last Sync:</dt><dd>{{ service_status.certificate_store.last_sync }}</dd>
                  </dl>
                </div>
              </div>
              
              <div class="health-card">
                <h6>OpenXPKI Integration</h6>
                <div class="health-status status-{{ service_status.openxpki.status|lower }}">
                  {{ service_status.openxpki.status }}
                </div>
                <div class="health-details">
                  <dl>
                    <dt>Connection:</dt><dd>{{ service_status.openxpki.connection_status }}</dd>
                    <dt>Version:</dt><dd>{{ service_status.openxpki.version }}</dd>
                    <dt>Last Check:</dt><dd>{{ service_status.openxpki.last_check }}</dd>
                  </dl>
                </div>
              </div>
            </div>
          {% endif %}
        </div>
        
        <!-- Configuration Information -->
        <div class="config-info">
          <h4>Configuration Information</h4>
          {% if config_info %}
            <div class="config-grid">
              <div class="config-section">
                <h6>Trust Store Configuration</h6>
                <dl>
                  <dt>Store Location:</dt><dd>{{ config_info.trust_store.location }}</dd>
                  <dt>Store Type:</dt><dd>{{ config_info.trust_store.type }}</dd>
                  <dt>Auto-sync:</dt><dd>{{ 'Enabled' if config_info.trust_store.auto_sync else 'Disabled' }}</dd>
                  <dt>Validation Mode:</dt><dd>{{ config_info.trust_store.validation_mode }}</dd>
                </dl>
              </div>
              
              <div class="config-section">
                <h6>Notification Configuration</h6>
                <dl>
                  <dt>Notifications:</dt><dd>{{ 'Enabled' if config_info.notifications.enabled else 'Disabled' }}</dd>
                  <dt>Email Server:</dt><dd>{{ config_info.notifications.smtp_server }}</dd>
                  <dt>Check Interval:</dt><dd>{{ config_info.notifications.check_interval }}</dd>
                </dl>
              </div>
            </div>
          {% endif %}
        </div>
      </div>
    </details>
  </article>
</section>

<script>
function clearFilters() {
  window.location.href = '/trust-anchor';
}

function viewTrustedCert(certId) {
  window.open(`/trust-anchor/certificate/${certId}`, '_blank');
}

function downloadTrustedCert(certId) {
  window.location.href = `/trust-anchor/certificate/${certId}/download`;
}

function editTrust(certId) {
  // Open edit trust dialog
  alert(`Edit trust settings for certificate: ${certId}`);
}

function removeTrust(certId) {
  if (confirm('Are you sure you want to remove this certificate from the trust store?')) {
    const form = document.createElement('form');
    form.method = 'POST';
    form.action = '/trust-anchor/remove-trusted';
    
    const input = document.createElement('input');
    input.type = 'hidden';
    input.name = 'certificate_id';
    input.value = certId;
    
    form.appendChild(input);
    document.body.appendChild(form);
    form.submit();
  }
}

function checkExpiringCertificates() {
  // Trigger expiry check
  fetch('/trust-anchor/check-expiring', { method: 'POST' })
    .then(response => response.json())
    .then(data => {
      window.location.reload();
    })
    .catch(error => {
      alert(`Error checking expiring certificates: ${error}`);
    });
}

function viewCertDetails(certId) {
  window.open(`/trust-anchor/certificate/${certId}/details`, '_blank');
}

function renewCert(certId) {
  alert(`Certificate renewal for: ${certId}`);
}

function refreshServiceStatus() {
  window.location.reload();
}
</script>

<style>
.validation-section,
.trust-store-section,
.expiry-section,
.status-section {
  margin-bottom: 2rem;
}

.add-trust-section {
  margin-bottom: 2rem;
  padding-bottom: 2rem;
  border-bottom: 1px solid var(--border-color);
}

.validation-details {
  background-color: var(--background-color);
  border-radius: 4px;
  padding: 1rem;
  margin-top: 1rem;
}

.validation-status {
  display: flex;
  gap: 1rem;
  align-items: center;
  margin-bottom: 1rem;
  padding-bottom: 1rem;
  border-bottom: 1px solid var(--border-color);
}

.trust-level {
  padding: 0.25rem 0.5rem;
  border-radius: 12px;
  font-size: 0.85em;
  font-weight: bold;
}

.trust-level.trust-high {
  background-color: rgba(76, 175, 80, 0.2);
  color: #2e7d32;
}

.trust-level.trust-medium {
  background-color: rgba(255, 193, 7, 0.2);
  color: #f57c00;
}

.trust-level.trust-low {
  background-color: rgba(244, 67, 54, 0.2);
  color: #c62828;
}

.cert-info-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1rem;
  margin-bottom: 1rem;
}

.info-section {
  background-color: rgba(255, 255, 255, 0.5);
  padding: 1rem;
  border-radius: 4px;
}

.info-section h6 {
  margin: 0 0 0.5rem 0;
  color: var(--primary-color);
  font-weight: bold;
}

.info-section dl {
  margin: 0;
}

.info-section dt {
  font-weight: bold;
  color: var(--text-color-secondary);
  font-size: 0.9em;
}

.info-section dd {
  margin: 0 0 0.5rem 0;
  color: var(--text-color);
  word-break: break-word;
}

.validation-errors,
.validation-warnings {
  margin-top: 1rem;
}

.error-list {
  color: var(--error-color);
  margin: 0.5rem 0;
  padding-left: 1.5rem;
}

.warning-list {
  color: #f57c00;
  margin: 0.5rem 0;
  padding-left: 1.5rem;
}

.trust-filters {
  background-color: var(--background-color);
  padding: 1rem;
  border-radius: 4px;
  border: 1px solid var(--border-color);
  margin-bottom: 1rem;
}

.filter-form {
  margin: 0;
}

.filter-actions {
  display: flex;
  gap: 0.5rem;
  margin-top: 1rem;
}

.trusted-certs-list {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
  gap: 1rem;
}

.trusted-cert-card {
  border: 1px solid var(--border-color);
  border-radius: 4px;
  padding: 1rem;
  background-color: var(--background-color);
}

.cert-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
}

.cert-title {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.cert-title h6 {
  margin: 0;
  font-size: 1em;
}

.cert-details {
  margin-bottom: 1rem;
}

.cert-details dl {
  margin: 0;
}

.cert-details dt {
  font-weight: bold;
  color: var(--text-color-secondary);
  font-size: 0.9em;
}

.cert-details dd {
  margin: 0 0 0.5rem 0;
  font-size: 0.95em;
}

.cert-actions {
  display: flex;
  gap: 0.25rem;
  flex-wrap: wrap;
}

.cert-actions .button {
  font-size: 0.8em;
  padding: 0.25rem 0.5rem;
}

.no-trusted-certs {
  text-align: center;
  padding: 2rem;
  color: var(--text-color-secondary);
  border: 2px dashed var(--border-color);
  border-radius: 4px;
}

.expiry-controls {
  margin-bottom: 2rem;
  padding-bottom: 2rem;
  border-bottom: 1px solid var(--border-color);
}

.expiry-alerts {
  margin-bottom: 2rem;
}

.alert-summary {
  margin: 1rem 0;
}

.alert-stats {
  display: flex;
  gap: 2rem;
  justify-content: center;
  flex-wrap: wrap;
}

.alert-stat {
  text-align: center;
  padding: 1rem;
  border-radius: 4px;
  min-width: 100px;
}

.alert-stat.critical {
  background-color: rgba(244, 67, 54, 0.1);
  border: 2px solid rgba(244, 67, 54, 0.3);
}

.alert-stat.urgent {
  background-color: rgba(255, 193, 7, 0.1);
  border: 2px solid rgba(255, 193, 7, 0.3);
}

.alert-stat.warning {
  background-color: rgba(156, 39, 176, 0.1);
  border: 2px solid rgba(156, 39, 176, 0.3);
}

.alert-stat strong {
  display: block;
  font-size: 1.5em;
  font-weight: bold;
}

.alert-stat span {
  font-size: 0.9em;
  color: var(--text-color-secondary);
}

.alert-section-title {
  margin: 1.5rem 0 1rem 0;
  font-weight: bold;
}

.alert-section-title.critical {
  color: #c62828;
}

.alert-section-title.urgent {
  color: #f57c00;
}

.cert-alerts-list {
  margin-bottom: 2rem;
}

.cert-alert {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem;
  margin-bottom: 0.5rem;
  border-radius: 4px;
}

.cert-alert.cert-expired {
  background-color: rgba(244, 67, 54, 0.1);
  border-left: 4px solid #c62828;
}

.cert-alert.cert-expiring-soon {
  background-color: rgba(255, 193, 7, 0.1);
  border-left: 4px solid #f57c00;
}

.cert-alert-info {
  flex: 1;
}

.cert-alert-info strong {
  display: block;
  margin-bottom: 0.25rem;
}

.expiry-date {
  font-size: 0.9em;
  color: var(--text-color-secondary);
}

.cert-alert-actions {
  display: flex;
  gap: 0.25rem;
}

.health-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1rem;
  margin-top: 1rem;
}

.health-card {
  border: 1px solid var(--border-color);
  border-radius: 4px;
  padding: 1rem;
  background-color: var(--background-color);
}

.health-card h6 {
  margin: 0 0 1rem 0;
  color: var(--primary-color);
}

.health-status {
  padding: 0.5rem 1rem;
  border-radius: 4px;
  font-weight: bold;
  text-transform: uppercase;
  margin-bottom: 1rem;
  text-align: center;
}

.health-status.status-healthy {
  background-color: rgba(76, 175, 80, 0.2);
  color: #2e7d32;
}

.health-status.status-degraded {
  background-color: rgba(255, 193, 7, 0.2);
  color: #f57c00;
}

.health-status.status-unhealthy {
  background-color: rgba(244, 67, 54, 0.2);
  color: #c62828;
}

.health-details dl {
  margin: 0;
}

.health-details dt {
  font-weight: bold;
  color: var(--text-color-secondary);
  font-size: 0.9em;
}

.health-details dd {
  margin: 0 0 0.5rem 0;
}

.config-info {
  margin-top: 2rem;
  padding-top: 2rem;
  border-top: 1px solid var(--border-color);
}

.config-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1rem;
  margin-top: 1rem;
}

.config-section {
  background-color: var(--background-color);
  padding: 1rem;
  border-radius: 4px;
  border: 1px solid var(--border-color);
}

.config-section h6 {
  margin: 0 0 1rem 0;
  color: var(--primary-color);
}

.form-row {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
}

.form-row .form-group {
  flex: 1;
  min-width: 200px;
}

.checkbox-label {
  display: flex;
  align-items: center;
  gap: 0.25rem;
  font-size: 0.9em;
}

.help-text {
  color: var(--text-color-secondary);
  font-size: 0.85em;
  display: block;
  margin-top: 0.25rem;
}

.result-section {
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid var(--border-color);
}

.status {
  padding: 0.25rem 0.5rem;
  border-radius: 12px;
  font-size: 0.85em;
  font-weight: bold;
  text-transform: uppercase;
}

.status-valid {
  background-color: rgba(76, 175, 80, 0.2);
  color: #2e7d32;
}

.status-invalid {
  background-color: rgba(244, 67, 54, 0.2);
  color: #c62828;
}

.status-active {
  background-color: rgba(76, 175, 80, 0.2);
  color: #2e7d32;
}

.status-expired {
  background-color: rgba(244, 67, 54, 0.2);
  color: #c62828;
}

.status-revoked {
  background-color: rgba(158, 158, 158, 0.2);
  color: #424242;
}
</style>
{% endblock %}